<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Patient Records System</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <style>
    .form-section {
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
    }
    .input-focus:focus {
      box-shadow: 0 0 0 3px rgba(74, 222, 128, 0.3);
    }
    .floating-label {
      position: absolute;
      top: 0.75rem;
      left: 1rem;
      transition: all 0.2s ease-out;
      pointer-events: none;
      color: #6b7280;
    }
    .input-filled ~ .floating-label,
    input:focus ~ .floating-label {
      top: -0.5rem;
      left: 0.8rem;
      font-size: 0.75rem;
      background: white;
      padding: 0 0.25rem;
      color: #10b981;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <div class="container mx-auto px-4 py-8">
    <!-- Header Section -->
    <!-- Header Section -->
    <header class="text-center mb-12 animate__animated animate__fadeIn">
      <div class="flex items-center justify-center mb-4">
        <div class="bg-teal-100 p-3 rounded-full mr-4">
          <i class="fas fa-clipboard-list text-teal-600 text-2xl"></i>
        </div>
        <h1 class="text-4xl md:text-5xl font-bold text-gray-800">
          Patient Records System
        </h1>
      </div>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">
        Secure and efficient patient data management for healthcare professionals
      </p>
    </header>

    <!-- Main Content -->
    <div class="flex flex-col lg:flex-row gap-8 items-start">
      <!-- Form Section -->
      <div class="w-full lg:w-1/2 animate__animated animate__fadeInLeft">
        <div class="form-section rounded-2xl shadow-xl overflow-hidden border border-green-100">
          <div class="bg-gradient-to-r from-green-500 to-teal-500 text-white text-center py-5 px-6">
            <h2 class="text-2xl font-bold">
              <i class="fas fa-user-plus mr-2"></i> New Patient Record
            </h2>
          </div>
          
          <form id="form" class="p-6 md:p-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Name Field -->
              <div class="relative">
                <input type="text" id="name" required 
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-green-500 transition duration-200">
                <label for="name" class="floating-label">Full Name</label>
              </div>
              
              <!-- Age Field -->
              <div class="relative">
                <input type="number" id="age" required 
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-green-500 transition duration-200">
                <label for="age" class="floating-label">Age</label>
              </div>
              
              <!-- Gender Field -->
              <div class="relative md:col-span-2">
                <select id="gender" required 
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-green-500 appearance-none transition duration-200">
                  <option value=""></option>
                  <option value="Male">Male</option>
                  <option value="Female">Female</option>
                  <option value="Other">Other</option>
                </select>
                <label for="gender" class="floating-label">Gender</label>
                <div class="absolute right-4 top-4 text-gray-400 pointer-events-none">
                  <i class="fas fa-chevron-down"></i>
                </div>
              </div>
              
              <!-- Medical History -->
              <div class="relative md:col-span-2">
                <textarea id="medicalHistory" required 
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-green-500 transition duration-200 h-24"></textarea>
                <label for="medicalHistory" class="floating-label">Medical History</label>
              </div>
              
              <!-- Allergies -->
              <div class="relative md:col-span-2">
                <textarea id="allergies" 
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-green-500 transition duration-200 h-20"></textarea>
                <label for="allergies" class="floating-label">Allergies (if any)</label>
              </div>
              
              <!-- Height -->
              <div class="relative">
                <input type="number" id="height" required 
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-green-500 transition duration-200">
                <label for="height" class="floating-label">Height (cm)</label>
              </div>
              
              <!-- Weight -->
              <div class="relative">
                <input type="number" id="weight" required 
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-green-500 transition duration-200">
                <label for="weight" class="floating-label">Weight (kg)</label>
              </div>
              
              <!-- Disease -->
              <div class="relative md:col-span-2">
                <input type="text" id="disease" required 
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-green-500 transition duration-200">
                <label for="disease" class="floating-label">Medical Condition</label>
              </div>
            </div>
            
            <button type="submit" id="submitButton"
              class="w-full mt-6 bg-gradient-to-r from-green-500 to-teal-500 text-white py-3 rounded-lg hover:from-green-600 hover:to-teal-600 transition duration-300 shadow-md hover:shadow-lg flex items-center justify-center">
              <i class="fas fa-save mr-2"></i>
              <span id="submitText">Save Patient Record</span>
              <span id="submitSpinner" class="ml-2 hidden">
                <i class="fas fa-spinner fa-spin"></i>
              </span>
            </button>
          </form>
        </div>
      </div>
      
      <!-- Info Section -->
      <div class="w-full lg:w-1/2 animate__animated animate__fadeInRight">
        <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 border border-gray-100">
          <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
            <i class="fas fa-info-circle text-green-500 mr-3"></i>
            About This System
          </h2>
          
          <div class="space-y-5">
            <div class="flex items-start">
              <div class="flex-shrink-0 mt-1">
                <div class="h-8 w-8 rounded-full bg-green-100 flex items-center justify-center">
                  <i class="fas fa-shield-alt text-green-500"></i>
                </div>
              </div>
              <div class="ml-4">
                <h3 class="text-lg font-semibold text-gray-800">Secure Data Storage</h3>
                <p class="text-gray-600 mt-1">All patient records are securely stored with encryption and access controls.</p>
              </div>
            </div>
            
            <div class="flex items-start">
              <div class="flex-shrink-0 mt-1">
                <div class="h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center">
                  <i class="fas fa-chart-line text-blue-500"></i>
                </div>
              </div>
              <div class="ml-4">
                <h3 class="text-lg font-semibold text-gray-800">Comprehensive Analytics</h3>
                <p class="text-gray-600 mt-1">Track patient trends and generate insightful reports with our dashboard.</p>
              </div>
            </div>
            
            <div class="flex items-start">
              <div class="flex-shrink-0 mt-1">
                <div class="h-8 w-8 rounded-full bg-purple-100 flex items-center justify-center">
                  <i class="fas fa-search text-purple-500"></i>
                </div>
              </div>
              <div class="ml-4">
                <h3 class="text-lg font-semibold text-gray-800">Easy Retrieval</h3>
                <p class="text-gray-600 mt-1">Quickly find patient records with our powerful search functionality.</p>
              </div>
            </div>
            
            <div class="pt-4 border-t border-gray-100">
              <div class="grid grid-cols-2 gap-4">
                <a href="/patients" class="flex items-center justify-center px-4 py-3 bg-gray-100 hover:bg-gray-200 rounded-lg transition duration-200 text-gray-700 font-medium">
                  <i class="fas fa-list mr-2"></i> View All Patients
                </a>
                <a href="/dashboard" class="flex items-center justify-center px-4 py-3 bg-blue-100 hover:bg-blue-200 rounded-lg transition duration-200 text-blue-700 font-medium">
                  <i class="fas fa-chart-bar mr-2"></i> View Dashboard
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById("form");
      const submitButton = document.getElementById("submitButton");
      const submitText = document.getElementById("submitText");
      const submitSpinner = document.getElementById("submitSpinner");

      // Add floating label functionality
      document.querySelectorAll('input, textarea, select').forEach(input => {
        // Check if already filled on page load
        if (input.value) {
          input.classList.add('input-filled');
        }
        
        // Add event listeners
        input.addEventListener('input', () => {
          if (input.value) {
            input.classList.add('input-filled');
          } else {
            input.classList.remove('input-filled');
          }
        });
        
        input.addEventListener('focus', () => {
          if (input.value) {
            input.classList.add('input-filled');
          }
        });
        
        input.addEventListener('blur', () => {
          if (!input.value) {
            input.classList.remove('input-filled');
          }
        });
      });

      form.addEventListener("submit", async (event) => {
        event.preventDefault();

        // Retrieve input values from the form
        const name = document.getElementById("name").value;
        const age = document.getElementById("age").value;
        const gender = document.getElementById("gender").value;
        const medicalHistory = document.getElementById("medicalHistory").value;
        const allergies = document.getElementById("allergies").value || "None";
        const height = document.getElementById("height").value;
        const weight = document.getElementById("weight").value;
        const disease = document.getElementById("disease").value;

        // Validate input fields
        if (!name || !age || !gender || !medicalHistory || !height || !weight || !disease) {
          Swal.fire({
            icon: 'warning',
            title: 'Incomplete Form',
            text: 'Please fill in all required fields.',
            confirmButtonColor: '#4CAF50',
            background: '#ffffff',
            backdrop: `
              rgba(0,0,0,0.08)
              url("/images/nyan-cat.gif")
              left top
              no-repeat
            `
          });
          return;
        }

        try {
          // Show loading state
          submitButton.disabled = true;
          submitText.textContent = "Saving...";
          submitSpinner.classList.remove("hidden");

          // Send form data to the server via POST request
          const response = await fetch("/submit", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ 
              name, 
              age, 
              gender, 
              medicalHistory, 
              allergies, 
              height, 
              weight, 
              disease 
            }),
          });

          const data = await response.text();

          if (response.ok) {
            Swal.fire({
              icon: 'success',
              title: 'Success!',
              text: data,
              confirmButtonColor: '#4CAF50',
              background: '#ffffff',
              customClass: {
                popup: 'animate__animated animate__bounceIn'
              }
            });
            form.reset();
            document.querySelectorAll('input, textarea, select').forEach(input => {
              input.classList.remove('input-filled');
            });
          } else {
            throw new Error(data);
          }
        } catch (error) {
          Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: 'Failed to save patient data.',
            confirmButtonColor: '#FF5722',
            background: '#ffffff'
          });
          console.error("Error:", error);
        } finally {
          // Reset button state
          submitButton.disabled = false;
          submitText.textContent = "Save Patient Record";
          submitSpinner.classList.add("hidden");
        }
      });
    });
  </script>
</body>
</html>